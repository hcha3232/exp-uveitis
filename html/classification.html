<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MCQDTPWJ');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Uveitis Tree" />
    <meta name="theme-color" content="#fbf8f8" />
    <title>Uveitis Tree</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="manifest" href="/manifest.json" />


    <link rel="apple-touch-icon" href="/img/icon192.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="white" />
    <meta name="apple-mobile-web-app-title" content="uveitis" />
</head>
<body style="background-color: #fbf8f8;">
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MCQDTPWJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <nav id="nav"> </nav>
    <div style="padding-top: 5rem;"></div>
    
    <div id="main-container" class="container" style="max-width: 600px;">
    <div id="accor">

    </div>
    </div>


    <div style="min-height: 100px"></div>

    <nav id="nav-footer" style="box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;"> </nav>
    <script src="/scripts/nav.js"></script>
    
    
    <script type="module">
        import { getApps, initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-database.js";
    
        // Your web app's Firebase configuration
        const firebaseConfig = {
                apiKey: "AIzaSyCzOmDJUdo4Zb6JdqyV4Z9wJAR-oNN3KPU",
                authDomain: "uveitistree.firebaseapp.com",
                projectId: "uveitistree",
                storageBucket: "uveitistree.appspot.com",
                messagingSenderId: "10694666072",
                appId: "1:10694666072:web:061c2e6f94e29361a0672d",
                databaseURL: "https://uveitistree-default-rtdb.asia-southeast1.firebasedatabase.app"
            };
    
        // Initialize Firebase
        if (!getApps().length) {
            // Initialize Firebase
            initializeApp(firebaseConfig);
        }
        const auth = getAuth();
        const db = getDatabase()
    
        // Check if a user is signed in
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in, you can access user data here
                console.log("User is signed in:");
                // Retrieve researchID from realtime db
                const userRef = ref(db, 'users/' + user.uid)
                get(userRef).then((snapshot) => {
                    if (snapshot.exists()) {
                        const researchID = snapshot.val().researchID;

                        localStorage.setItem('researchID', researchID);

                        // Push to dataLayer
                        window.dataLayer = window.dataLayer || [];
                        window.dataLayer.push({
                            'event': 'userLogin',
                            'userID': researchID
                        });
                    }
                });
            } else {
                // No user is signed in, redirect to login page or handle as desired
                console.log("No user is signed in");
                // Example: redirect to login page
                window.location.href = '/login.html';
            }
        });

        const LogOutBtn = document.getElementById('signOutBtn')
        LogOutBtn.addEventListener('click', ()=> {
            signOut(auth).then(() => {
                // Sign-out successful.
                window.location.href = '/login.html';
            }).catch((error) => {
                // An error happened.
            });
        })
        
    </script>
    <script>
        let classIcon = document.getElementById('class-icon');
        classIcon.style.color = '#000';
        classIcon.style.borderTop = '2px solid black';
    </script>
    <script type="module" src="/scripts/accor.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js" integrity="sha384-zYPOMqeu1DAVkHiLqWBUTcbYfZ8osu1Nd6Z89ify25QV9guujx43ITvfi12/QExE" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script>
</body>
</html>
